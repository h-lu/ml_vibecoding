### ch03 审阅报告（已完成 5/5）

#### 概览
- **章节**: ch03（第三章：第一性原理工具箱——数学与物理直觉激活）
- **小节清单与定位**:
  - ch03/3_1_vector_space.qmd（存在）
  - ch03/3_2_probability.qmd（存在）
  - ch03/3_3_optimization.qmd（存在）
  - ch03/3_4_vibe_coding_practice.qmd（存在）
  - ch03/3_5_exercises.qmd（存在）
- **总体评估**:
  - **FP（第一性原理）**: 3/4（向量/概率/优化三基石叙事清晰；建议加入更严格的边界条件与反例）
  - **VC（Vibe Coding）**: 3/4（有交互与物理类比；概率一节 ipywidgets 在静态站点可用性存疑）
  - **BP（最佳实践）**: 3/4（建议补：相似度/尺度化、概率校准与阈值调优、优化器与调度器、数值稳定性）
  - **一句话结论**: 本章用直觉连接几何/概率/优化，建议补齐“可运行交互资产”和“工程化要点（校准/阈值/稳定性）”，并新增实践与练习两节闭环落地。

#### 证据与问题（按小节）
- 3_1_vector_space（`ch03/3_1_vector_space.qmd`）
  - 关键论断：万物向量化；相似≈几何距离；以可视化交互说明“最近邻=最相似”。
  - 证据链接（Context7）：
    - sklearn pairwise 距离/核与余弦相似度：cosine_similarity、pairwise_distances、pairwise_kernels（v1.6+支持 Array API；稀疏矩阵可用）
    - KDTree/BallTree 支持的度量族、非欧式度量支持
  - 风险与边界：
    - 尺度/量纲不一致会扭曲欧氏距离；建议强调标准化/归一化与“什么时候用余弦更合适（如 TF-IDF 向量）”。
    - 高维距离集中（curse of dimensionality）提示与“选择度量”折衷（L2/L1/chi2/RBF 等）。
    - 类别型/混合型特征需编码或专用距离（如 Gower/自定义 metric）；避免将 one-hot 与实数特征直接混合欧氏距离。

- 3_2_probability（`ch03/3_2_probability.qmd`）
  - 关键论断：预测应解释为概率陈述；用先验-证据-后验展示不确定性更新；强调“拥抱不确定性”。
  - 证据链接（Context7）：
    - 概率校准：CalibratedClassifierCV（sigmoid/isotonic）、CalibrationDisplay、Brier 分数（多分类支持）
    - 不同模型校准偏差：GaussianNB（过于极端）、RandomForest（过于接近 0.5）、LogisticRegression（通常较好）
    - 分类阈值调优：TunedThresholdClassifierCV / FixedThresholdClassifier（sklearn 1.5+）；classification_threshold 指南
  - 风险与边界：
    - 本书当前使用 ipywidgets 交互（`ipywidgets.interact`）在静态 Quarto 站点可能无法运行；建议改为预渲染 HTML 资产或纯前端交互（Plotly+JS），并入 `book/assets/ch03/`。
    - 明确“概率 vs 分数（decision_function）”与“pos_label/average/Brier/PR-ROC 的适用性”；避免将未校准分数当概率解读。

- 3_3_optimization（`ch03/3_3_optimization.qmd`）
  - 关键论断：训练=最小化损失的“下山过程”；学习率与初始点影响收敛；交互演示 GD 直觉。
  - 证据链接（Context7）：
    - SciPy `optimize.minimize` 方法族（BFGS/L-BFGS-B/SLSQP/trust-constr 等）
    - PyTorch 优化器/调度器：AdamW（解耦权重衰减）、CosineAnnealingLR、SWA/EMA 实用工具
  - 风险与边界：
    - 建议加入数值稳定性要点：log-sum-exp trick、梯度裁剪、损失缩放；
    - 区分凸/非凸；批/小批与随机性；步长/线搜索与 Lipschitz 条件的直觉；
    - 提示“Adam≠免调参”，引入 AdamW 与余弦退火/重启等调度策略的直观示例。

- 3_4_vibe_coding_practice（`ch03/3_4_vibe_coding_practice.qmd`）
  - 关键论断：以“让 AI 成为数学老师”为目标，指导 AI 先生成 GD 动画初稿，再由人类进行教学化优化（清晰度/交互性/类比性）。
  - 证据与最佳实践：
    - 动画生成依赖 Matplotlib/动画写出器（如 ffmpeg）；静态站点建议预渲染为 mp4/gif 并存入 `assets/ch03/` 再以 `<video>` 或 iframe 引用；
    - 若需交互，优先 Plotly 前端交互（避免 ipywidgets 在静态站点的不确定性）。
  - 风险与边界：
    - 运行环境差异（本地 vs 静态站点）导致动画无法展示；需在文中注明“运行版”和“发布版”路径；
    - 学习率/初始点演示需提示“示例仅为凸一维情形”，避免读者误推至一般非凸场景。
  - 建议补充：提供“预渲染资产制作脚本”与可运行 `notebook`，并在文末给出“课堂演示清单”（学习率过大震荡、过小收敛慢、不同初始点对比）。

- 3_5_exercises（`ch03/3_5_exercises.qmd`）
  - 内容概览：几何直觉练习、概率思维练习、Vibe Coding 可视化挑战（贝叶斯更新）。
  - 评审结论：
    - FP：题目贴合本章三基石，强调“几何/概率/优化”直觉迁移；
    - VC：以提示词驱动人机协作，并要求人类优化与叙事，契合 VC；
    - BP：建议补“评分 Rubric 与最小提交物模板（问题→图表选择→洞察→行动→限制）”，并明确是否要求提交源码/渲染资产。
  - 建议补充：
    - 为每题提供“提示/误区”与“参考答案大纲”；
    - 对交互类作业，要求提交 `html` 预渲染资产以保证阅览；
    - 对概率题，鼓励给出“先验/似然/后验”的可视化草图与口头说明。

#### 修订建议与优先级
- **P0**：
  - 将 3.2 的 ipywidgets 互动替换为预渲染 HTML 或纯前端交互，统一放入 `book/assets/ch03/` 并更新引用；校验所有 iframe 与资源链接可用。
  - 在 3.2 明确“概率/分数/pos_label/average/代价函数”的术语与使用规范，避免误读概率。

- **P1**：
  - 3.1 增补“尺度化与度量选择”小节，附 sklearn pairwise 示例与“何时选余弦”的指引；提示高维距离集中与度量折衷。
  - 3.2 增补“概率校准与阈值调优”段落（CalibratedClassifierCV、Brier、TunedThresholdClassifierCV），并提供一个最小例子与可视化（CalibrationDisplay/PR 曲线）。
  - 3.3 增补“优化器与调度器实务”和“数值稳定性”要点（AdamW、CosineAnnealingLR、SWA/EMA、log-sum-exp、梯度裁剪）。
  - 新增 3.4/3.5 文件与内容，形成“概念→实践→作业”的闭环。

- **P2**：
  - 各节末加入“检查清单”：术语/公式/可视化/代码可复现/资源有效性。
  - 统一图例与符号记法；在长图添加读者指引（标注关键点/颜色图例）。

#### 资源与可复现性
- 代码/数据/环境：
  - 建议在 `book/code/ch03/` 提供三个最小示例：pairwise 相似度对比、概率校准与阈值扫描、优化器与调度器曲线；
  - 为交互图输出独立 HTML（Plotly）并存入 `book/assets/ch03/`，Quarto 页面以 iframe 引用，避免运行时依赖。
  - 已添加 GD 预渲染动画脚本：`book/assets/ch03/gd_animation_plotly.py`（生成 `gd_animation.html` 以供 3.4 引用）。
- 资产检查：
  - 已用资产：`assets/ch03/vector_space_similarity.html`、`assets/ch03/gd_manual.html`；
  - 待补资产：概率交互演示（新建），所有链接与高度自适应检查。

#### 术语与引用（访问日期 2025-08）
- sklearn Pairwise 度量与相似度：[Pairwise metrics, affinities and kernels](https://scikit-learn.org/stable/modules/metrics.html#pairwise-metrics)
- sklearn 概率校准与可视化：[Probability calibration](https://scikit-learn.org/stable/modules/calibration.html)
- sklearn 支持向量机概率/分数说明：[SVMs — Scores and probabilities](https://scikit-learn.org/stable/modules/svm.html#scores-probabilities)
- sklearn 决策阈值与新类（1.5+）：[TunedThresholdClassifierCV](https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.TunedThresholdClassifierCV.html)
- SciPy 优化 API（方法族与参数）：[`scipy.optimize.minimize`](https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.minimize.html)
- PyTorch 优化器：[`torch.optim.AdamW`](https://pytorch.org/docs/stable/generated/torch.optim.AdamW.html)
- PyTorch 学习率调度器：[`CosineAnnealingLR`](https://pytorch.org/docs/stable/generated/torch.optim.lr_scheduler.CosineAnnealingLR.html)
- PyTorch SWA/EMA 实用工具：[`torch.optim.swa_utils`](https://pytorch.org/docs/stable/optim.html#stochastic-weight-averaging-swa)
- 数值稳定性（对数-和-指数）：[`torch.logsumexp`](https://pytorch.org/docs/stable/generated/torch.logsumexp.html)

#### 状态与动作
- 审核状态：进行中（已完成 3_1/3_2/3_3；3_4/3_5 待新增并审核）
- 责任人 / 截止：AI 助理 / 本周
- 变更记录：新增 FP/VC/BP 评分与修订清单；提出交互资产替换方案与实践/练习大纲。
