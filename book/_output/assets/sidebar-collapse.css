/* 侧边栏折叠样式 - 覆盖Quarto默认样式 */

/* 隐藏Quarto默认的折叠行为 */
.sidebar .sidebar-menu .sidebar-item[data-bs-toggle="collapse"],
.sidebar .sidebar-menu .collapse {
    display: block !important;
}

/* 移除Bootstrap的collapse类的默认行为 */
.sidebar .collapse:not(.show) {
    display: block !important;
    height: auto !important;
}

/* 自定义手风琴样式 */
.sidebar-section-header {
    position: relative;
    padding: 0.75rem 1rem !important;
    background-color: var(--chatgpt-surface, #f7f7f8) !important;
    border-bottom: 1px solid var(--chatgpt-border, #e5e5e5);
    cursor: pointer;
    transition: all 0.2s ease;
    font-weight: 600;
    color: var(--chatgpt-primary, #000000);
    display: flex;
    align-items: center;
    justify-content: space-between;
}

.sidebar-section-header:hover {
    background-color: #eeeeee !important;
}

.sidebar-section-header .chevron {
    font-size: 0.8rem;
    color: var(--chatgpt-secondary, #6b7280);
    transition: transform 0.2s ease;
    margin-left: auto;
}

.sidebar-section-header.collapsed .chevron {
    transform: rotate(-90deg);
}

.sidebar-section-content {
    overflow: hidden;
    transition: max-height 0.3s ease;
    background-color: var(--chatgpt-background, #ffffff);
}

.sidebar-section-content.collapsed {
    max-height: 0 !important;
}

.sidebar-section-content.expanded {
    max-height: 1000px !important;
}

.sidebar-section-content .sidebar-item,
.sidebar-subsection-item {
    padding: 0.5rem 1.5rem !important;
    border-left: 3px solid transparent;
    transition: all 0.2s ease;
    font-size: 0.875rem;
    margin: 0 !important;
}

.sidebar-section-content .sidebar-item:hover,
.sidebar-subsection-item:hover {
    background-color: var(--chatgpt-surface, #f7f7f8) !important;
    border-left-color: var(--chatgpt-accent, #10a37f);
}

.sidebar-section-content .sidebar-item.active,
.sidebar-subsection-item.active {
    background-color: rgba(16, 163, 127, 0.1) !important;
    border-left-color: var(--chatgpt-accent, #10a37f);
    font-weight: 500;
}

.sidebar-section-content .sidebar-item a,
.sidebar-subsection-item a {
    color: var(--chatgpt-secondary, #6b7280);
    text-decoration: none;
    display: block;
}

.sidebar-section-content .sidebar-item a:hover,
.sidebar-subsection-item a:hover {
    color: var(--chatgpt-primary, #000000);
}

.sidebar-section-content .sidebar-item.active a,
.sidebar-subsection-item.active a {
    color: var(--chatgpt-primary, #000000);
}

/* 确保手风琴处理的项目样式正确 */
.accordion-processed {
    background-color: var(--chatgpt-surface, #f7f7f8) !important;
    border-bottom: 1px solid var(--chatgpt-border, #e5e5e5);
}

/* 针对Quarto特定的结构调整 */
.quarto-sidebar .sidebar-menu {
    padding: 0;
}

.quarto-sidebar .sidebar-menu .sidebar-item {
    border-radius: 0;
    margin: 0;
    border: none;
}

/* 搜索框样式保持在顶部 */
.sidebar-search {
    border-bottom: 1px solid var(--chatgpt-border, #e5e5e5);
    padding-bottom: 1rem;
    margin-bottom: 1rem;
}

/* 修复可能的样式冲突 */
.sidebar .sidebar-menu > .sidebar-item {
    margin-bottom: 0;
}

/* 确保图标对齐 */
.sidebar-section-header > * {
    pointer-events: none;
}

.sidebar-section-header .chevron {
    pointer-events: none;
    flex-shrink: 0;
}

/* 动画优化 */
@media (prefers-reduced-motion: reduce) {
    .sidebar-section-header .chevron,
    .sidebar-section-content {
        transition: none;
    }
}

/* 移动端优化 */
@media (max-width: 768px) {
    .sidebar-section-header {
        padding: 0.5rem 0.75rem !important;
        font-size: 0.9rem;
    }
    
    .sidebar-section-content .sidebar-item,
    .sidebar-subsection-item {
        padding: 0.4rem 1rem !important;
        font-size: 0.8rem;
    }
}

/* 确保正确的层级 */
.sidebar-section-header {
    z-index: 1;
    position: relative;
}

.sidebar-section-content {
    z-index: 0;
    position: relative;
}